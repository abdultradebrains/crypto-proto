import"../chunks/CWj6FrbW.js";import"../chunks/CQABdrtb.js";import{w as Y,c as K,s as W,e as I,o as Q}from"../chunks/9ZkQc-hj.js";import{p as P,f as A,b as f,c as U,d as h,r as v,s as F,t as N,Y as T,k as e,aw as J,a as R,i as z,l as X,az as C,aA as Z,S as x,R as w}from"../chunks/AWGgylXS.js";import{i as j}from"../chunks/C_4fyel-.js";import{p as $,s as ee,a as te}from"../chunks/CFr9uBtg.js";import{e as D,i as O,s as L}from"../chunks/C7FwJ61l.js";const se=!0,he=Object.freeze(Object.defineProperty({__proto__:null,prerender:se},Symbol.toStringTag,{value:"Module"})),G=Y({});function ae(E,b){const p=new WebSocket(E);p.onopen=()=>{console.log("WebSocket connection established."),b&&(p.send(JSON.stringify(b)),console.log("Subscription message sent."))},p.onmessage=m=>{try{const c=JSON.parse(m.data);c&&c.symbol&&c.type==="v2/ticker"&&G.update(u=>({...u,[c.symbol]:c}))}catch(c){console.error("Error parsing incoming WebSocket data:",c)}},p.onerror=m=>{console.error("WebSocket error:",m)},p.onclose=()=>{console.log("WebSocket connection closed.")}}var le=A("<button> </button>"),re=A("<button> </button>"),ie=A('<div class="filter-container svelte-mgkby8"><div class="asset-filters svelte-mgkby8"></div> <div class="expiry-filters svelte-mgkby8"></div></div>');function oe(E,b){P(b,!1);let p=$(b,"availableAssets",24,()=>[]),m=$(b,"availableExpiries",24,()=>[]),c=$(b,"selectedAsset",8),u=$(b,"selectedExpiry",8);const _=K();function y(s){_("selectAsset",s)}function S(s){_("selectExpiry",s)}j();var g=ie(),r=h(g);D(r,5,p,O,(s,i)=>{var a=le();let d;var t=h(a,!0);v(a),N(l=>{d=L(a,1,"svelte-mgkby8",null,d,l),W(t,e(i))},[()=>({active:c()===e(i)})],T),I("click",a,()=>y(e(i))),f(s,a)}),v(r);var n=F(r,2);D(n,5,m,O,(s,i)=>{var a=re();let d;var t=h(a,!0);v(a),N(l=>{d=L(a,1,"svelte-mgkby8",null,d,l),W(t,e(i))},[()=>({active:u()===e(i)})],T),I("click",a,()=>S(e(i))),f(s,a)}),v(n),v(g),f(E,g),U()}var ne=A("<th> </th>"),ce=A("<td> </td>"),ve=A('<tr class="svelte-6v4bw5"></tr>'),be=A('<div class="options-table-wrapper svelte-6v4bw5"><table class="options-table svelte-6v4bw5"><thead><tr></tr></thead><tbody class="svelte-6v4bw5"></tbody></table></div>');function ue(E,b){P(b,!1);let p=$(b,"contracts",24,()=>[]);const m=[{key:"call",label:"Calls",fields:[{label:"Delta",value:"greeks.delta"},{label:"Theta",value:"greeks.theta"},{label:"Spot",value:"greeks.spot"},{label:"Bid",value:"quotes.best_bid"},{label:"Bid Size",value:"quotes.bid_size"},{label:"Ask",value:"quotes.best_ask"},{label:"Ask Size",value:"quotes.ask_size"},{label:"Mark",value:"mark_price"},{label:"Mark Chg 24h",value:"mark_change_24h"},{label:"OI",value:"oi"}]},{key:"center",label:"Central",fields:[{label:"Strike",value:"strike_price"}]},{key:"put",label:"Puts",fields:[{label:"OI",value:"oi"},{label:"Bid Size",value:"quotes.bid_size"},{label:"Bid",value:"quotes.best_bid"},{label:"Ask",value:"quotes.best_ask"},{label:"Ask Size",value:"quotes.ask_size"},{label:"Mark",value:"mark_price"},{label:"Delta",value:"greeks.delta"},{label:"Theta",value:"greeks.theta"}]}];function c(r,n){if(!r||!n)return"-";const s=n.split(".").reduce((i,a)=>i&&i[a]!==void 0?i[a]:void 0,r);return s==null?"-":isNaN(parseFloat(s))?s:parseFloat(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:4})}j();var u=be(),_=h(u),y=h(_),S=h(y);D(S,5,()=>m,O,(r,n)=>{var s=J(),i=R(s);D(i,1,()=>(e(n),z(()=>e(n).fields)),O,(a,d)=>{var t=ne();let l;var o=h(t,!0);v(t),N(k=>{l=L(t,1,"svelte-6v4bw5",null,l,k),W(o,(e(d),z(()=>e(d).label)))},[()=>({"strike-header":e(n).key==="center"})],T),f(a,t)}),f(r,s)}),v(S),v(y);var g=F(y);D(g,5,p,r=>r.strike,(r,n)=>{var s=ve();D(s,5,()=>m,O,(i,a)=>{var d=J(),t=R(d);D(t,1,()=>(e(a),z(()=>e(a).fields)),O,(l,o)=>{var k=ce();const q=T(()=>(e(a),e(n),z(()=>e(a).key==="put"?e(n).put:e(n).call)));let B;var M=h(k,!0);v(k),N((H,V)=>{B=L(k,1,"svelte-6v4bw5",null,B,H),W(M,V)},[()=>({"strike-price":e(o).value==="strike_price",bid:e(o).label.includes("Bid"),ask:e(o).label.includes("Ask")}),()=>(X(e(q)),e(o),z(()=>c(e(q),e(o).value)))],T),f(l,k)}),f(i,d)}),v(s),f(r,s)}),v(g),v(_),v(u),f(E,u),U()}var de=A('<main class="svelte-11tqb00"><header class="svelte-11tqb00"><h1 class="svelte-11tqb00">Options Chain</h1></header> <!> <!></main>');function Se(E,b){P(b,!1);const[p,m]=ee(),c=()=>te(G,"$optionsData",p),u=w(),_=w(),y=w(),S=w(),g=w();Q(()=>{ae("wss://socket.delta.exchange",{type:"subscribe",payload:{channels:[{name:"v2/ticker",symbols:["call_options","put_options"]}]}})});let r=w("BTC"),n=["BTC","ETH"],s=w("04 Jul 25");C(()=>c(),()=>{x(u,Object.values(c()))}),C(()=>(e(u),e(r)),()=>{x(_,[...new Set(e(u).filter(t=>t.underlying_asset_symbol===e(r)).map(t=>{const[,,,l]=t.symbol.split("-"),o=l.slice(0,2),k=new Date(`2000-${l.slice(2,4)}-01`).toLocaleString("en-US",{month:"short"}),q=l.slice(4,6);return`${o} ${k} ${q}`}))].sort((t,l)=>new Date(t).getTime()-new Date(l).getTime()))}),C(()=>(e(u),e(r),e(s)),()=>{x(y,e(u).filter(t=>{if(!t.symbol)return!1;const[,l,,o]=t.symbol.split("-"),k=o.slice(0,2),q=new Date(`2000-${o.slice(2,4)}-01`).toLocaleString("en-US",{month:"short"}),B=o.slice(4,6),M=`${k} ${q} ${B}`;return l===e(r)&&e(s)===M}))}),C(()=>e(y),()=>{x(S,e(y).reduce((t,l)=>{const o=l.strike_price;return t[o]||(t[o]={strike:parseFloat(o)}),l.symbol.startsWith("C-")?t[o].call=l:l.symbol.startsWith("P-")&&(t[o].put=l),t},{}))}),C(()=>e(S),()=>{x(g,Object.values(e(S)).sort((t,l)=>t.strike-l.strike))}),Z(),j();var i=de(),a=F(h(i),2);oe(a,{get availableAssets(){return n},get availableExpiries(){return e(_)},get selectedAsset(){return e(r)},get selectedExpiry(){return e(s)},$$events:{selectAsset:t=>{x(r,t.detail),e(_).length>0&&x(s,e(_)[0])},selectExpiry:t=>x(s,t.detail)}});var d=F(a,2);ue(d,{get contracts(){return e(g)}}),v(i),f(E,i),U(),m()}export{Se as component,he as universal};
